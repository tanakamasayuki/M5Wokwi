# AGENTS

## ミッションステートメント
M5UnifiedW は、Wokwi シミュレータ上で M5Stack ハードウェアの最小限の機能を再現する Arduino 互換ライブラリです。`#include "M5Unified.h"` を `#include "M5UnifiedW.h"` に置き換えるだけで、実機を用意せずにディスプレイ描画やボタン操作の検証ができる環境を提供することを目標とします。

## 行動指針
- **ドロップイン互換性:** シミュレータ固有の制約を踏まえつつ、可能な限り M5Unified の公開 API を再現します。
- **決定論的なシミュレーション:** ハードウェア特有の癖よりも、再現性の高いタイミングと挙動を優先します。
- **漸進的な改善:** もっとも簡潔な抽象化から着手し、小さく記録を残しながら継続的に改良します。
- **透明な制約共有:** 実機との相違点を事前に明示し、利用者が驚かないようにします。
- **バイリンガル規約:** プロジェクト文書は日本語で記述し、コード内コメントは英語で統一して多様な開発者が理解できるようにします。

## コラボレーションフロー
1. **Small pull requests:** 長期間のブランチよりも小さく区切ったプルリクエストを優先します。
2. **レビュー・チェックリスト:** コーディング規約、API 互換性、シミュレーター挙動、ドキュメント、テストを確認します。
3. **Changelog 更新:** リリース対象の変更は毎回 `CHANGELOG.md` を更新します。

## リリースとバージョニング戦略
- 初期バージョンは `0.1.0` から開始し、公開 API が安定した時点でセマンティックバージョニングに従います。
- Wokwi 上でのリグレッションテストとサンプルスケッチの実行が問題なく完了した後にタグを付与します。
- Arduino Library Manager への登録準備が整い次第、事前ビルド済み `.zip` アーカイブを提供します。

## 未解決の論点
- 初期マイルストーンで実装すべき M5Unified API（ディスプレイ、ボタン、電源、IMU など）の範囲は？
- シミュレータ専用のヘルパー機能をどのように公開すればメインの名前空間を汚染せずに済むか？
- Wokwi のリグレッションを防ぐために CI 上でどのような自動チェックを走らせるべきか？
- フレームバッファレベルのエミュレーションが必要か、それとも高レベルの描画呼び出しで十分か？

これらの問いに対する決定は、適宜 ADR または README に反映します。
